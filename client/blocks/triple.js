!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sdk=t():e.sdk=t()}(this,(function(){return(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{default:()=>R});var n="https://tripleplaypay.com/iframe",r="MISSING_ENV_VAR".APP_API_BASE_URL,o=["credit_card","bank","crypto","terminal","digital"],i=["floating","static"],a="tpp_iframe",s={CHARGE:"charge",SAVE:"save"},l={REQUIRED:"required",DISABLED:"disabled"},c={CHARGE:"charge",AUTHORIZE:"authorize",SUBSCRIPTION:"subscription"},u="required",h=!1;function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){y(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(e){return f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},f(e)}var m=function(e,t){return e===c.CHARGE?t:t.filter((function(e){return"credit_card"===e}))},v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=encodeURIComponent(JSON.stringify(e)),n=btoa(t),r="?params=".concat(n);return r},g=function(e,t,r){return r?r.includes("https://")?r:"".concat(n.replace("/iframe","")).concat(r):"".concat(n,"/").concat(e).concat(t)},b=function e(t,n,r){var o=t[0];if(!n[o]&&t.length>1&&(n[o]={}),1!==t.length)return e(t.slice(1,t.length),n[o],r);n[o]=r},k=function(e){return e>=10?e:"0".concat(e)},S=function(e,t){var n=!1;for(var r in t)t[r]===e&&(n=!0);return n},w={borderBottom:{custom:{borderLeftStyle:"hidden",borderTopStyle:"hidden",borderRightStyle:"hidden",borderRadius:"0",background:"transparent"},0:"borderWidth",1:"borderStyle",2:"borderColor"}},P=function(e){for(var t=e.key,n=(e.value||"").split(" "),r=w[t],o={},i=0;i<n.length;i++)o[r[i]]=n[i];return r.custom&&"object"===f(r.custom)&&(o=d(d({},o),r.custom)),o},O=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n={};for(var r in t)t[r]?w[r]?n=d(d({},n),P({key:r,value:t[r]})):"object"===f(t[r])?n=d(d({},n),{},y({},r,e(t[r]))):n[r]=t[r]:n[r]=t[r];return n},C="width: 500px; min-height: ".concat(390,"px; border: none; max-width: 100vw;");function E(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}const T=function(){function e(t){var n=t.iframe,r=t.messageHandler;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.iframe=n,this.messageHandler=r}var t,n;return t=e,(n=[{key:"send",value:function(e){if(!this.iframe)throw new Error("Iframe is not selected");this.iframe.contentWindow.postMessage(e,"*")}},{key:"subscribe",value:function(){window.onmessage=this.messageHandler}},{key:"unsubscribe",value:function(){window.onmessage=function(){}}}])&&E(t.prototype,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function I(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?I(Object(n),!0).forEach((function(t){_(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):I(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function A(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B=["charge","subscription","authorize"],M=c.CHARGE,z={terminals:[]},R=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.appKey=t,z.terminals=[],this.laneId=null,this.paymentOptions=[]}var t,p;return t=e,(p=[{key:"form",value:function(e){var t=e.url,n=e.containerSelector,r=e.onError,o=void 0===r?function(){}:r,i=e.onSuccess,a=void 0===i?function(){}:i,s=e.newWindow,l=e.styles,c=e.meta,u=void 0===c?{}:c,h=e.meta_id,p=void 0===h?null:h,d=e.height,y=e.secure_form,f=void 0===y?null:y;t?(this.containerSelector=n,this.url=t,this.newWindow=s,this.onSuccess=a,this.onError=o,this.styles=O(l||{}),this.meta=u,this.meta_id=p,this.secure_form=f,this.height=d,this.init(),this.newWindow||this.setFormIframeHeight()):console.error("Form url is not provided")}},{key:"setFormIframeHeight",value:function(){var e=this.getIframeElement();if(e&&this.height){var t=parseInt(this.height);e.style.height="".concat(t,"px"),e.style.minHeight="".concat(t,"px")}}},{key:"generatePaymentForm",value:function(e){var t,n=e.paymentType,r=void 0===n?M:n,a=e.containerSelector,p=e.amount,d=e.onError,y=void 0===d?function(){}:d,f=e.onSuccess,v=void 0===f?function(){}:f,g=e.newWindow,b=e.styles,w=e.allowTip,P=e.tipValue,C=e.zipMode,E=void 0===C?l.REQUIRED:C,T=e.address,I=e.resize,j=e.payBtnText,A=e.start,_=e.cycles,z=e.interval,R=e.frequency,x=e.trial,N=e.email,W=e.fee,D=e.tokenMode,H=e.savePaymentToken,F=void 0===H||H,L=e.laneId,U=e.paymentOptions,V=void 0===U?m(r,o):U,q=e.meta,Y=void 0===q?{}:q,K=e.meta_id,G=void 0===K?null:K,J=e.secure_form,Q=void 0===J?null:J,Z=e.autocomplete,X=void 0===Z||Z,$=e.fullName,ee=void 0===$?h:$,te=e.billingAddress,ne=void 0===te?h:te,re=e.optIn,oe=void 0===re?h:re,ie=e.emailOption,ae=void 0===ie?u:ie,se=e.phoneOption,le=void 0===se?u:se,ce=e.terms,ue=e.labels,he=void 0===ue?i[0]:ue,pe=e.description;if(this.element)return this;if(!B.includes(r))return console.error("Invalid payment type"),void console.warn("Available values: ".concat(B.join(", ")));if(!Array.isArray(V))return console.error("Invalid payment options type"),void console.warn("Available values: ".concat(o.join(", ")));for(var de=0;de<V.length;de++)if(!o.includes(V[de]))return console.error('Invalid payment options value "'.concat(V[de],'"')),void console.warn("Available values: ".concat(o.join(", ")));if(D===s.SAVE&&(V.includes("terminal")||V.includes("crypto"))&&console.warn('"save" tokenMode supports only card/bank account payment types'),!this.validateTerminal())throw new Error("Selected terminal doesn't exist");if(this.paymentType=r,this.paymentOptions=m(r,V),!this.paymentOptions.length)throw new Error("No valid payment options specified");if(!S(E,l))throw new Error("Such zipMode option doesn't exist");return S(he,i)||(console.error("Such labels option doesn't exist"),console.warn("Available options are: ".concat(i.join(", ")))),this.zipMode=E,this.laneId=L,this.allowTip=!!w,this.tipValue=P,this.savePaymentToken=F,this.resize=I,this.payBtnText=j,this.address=T,this.fee=W,this.containerSelector=a,this.amount=p,this.iframe=null,this.onError=y,this.onSuccess=v,this.element=null,this.styles=O(b||this.styles||{}),r===c.SUBSCRIPTION&&(this.start=A||(t=new Date,"".concat(t.getFullYear(),"-").concat(k(t.getMonth()+1),"-").concat(k(t.getDate())))),this.trial=x,this.cycles=_,this.interval=z,this.frequency=R,this.email=N,this.tokenMode=D||!1,this.newWindow=g,this.meta=Y,this.meta_id=Q||G,this.autocomplete=X,this.fullName=ee,this.billingAddress=ne,this.optIn=oe,this.emailOption=ae,this.phoneOption=le,this.terms=ce,this.labels=he,this.description=pe,this.init(),this}},{key:"crypto",value:function(e){var t=e.containerSelector,n=e.amount,r=e.allowTip,i=e.tipValue,a=e.onError,s=void 0===a?function(){}:a,l=e.onSuccess,c=void 0===l?function(){}:l,p=e.newWindow,d=e.styles,y=void 0===d?{}:d,f=e.address,m=e.payBtnText,v=e.resize,g=e.fee,b=e.meta,k=void 0===b?{}:b,S=e.meta_id,w=void 0===S?null:S,P=e.secure_form,O=void 0===P?null:P,C=e.fullName,E=void 0!==C&&C,T=e.billingAddress,I=void 0===T?h:T,j=e.optIn,A=void 0===j?h:j,_=e.emailOption,B=void 0===_?u:_,z=e.phoneOption,R=void 0===z?u:z,x=e.terms,N=e.labels,W=e.description,D=M;return this.generatePaymentForm({containerSelector:t,paymentType:D,allowTip:r,tipValue:i,paymentOptions:[o[2]],amount:n,onError:s,onSuccess:c,newWindow:p,styles:y,address:f,resize:v,payBtnText:m,fee:g,meta:k,meta_id:w,secure_form:O,fullName:E,billingAddress:I,optIn:A,emailOption:B,phoneOption:R,terms:x,labels:N,description:W})}},{key:"getTerminals",value:function(){var e=new XMLHttpRequest;return e.open("get","".concat(r,"/terminal")),e.responseType="json",e.setRequestHeader("Authorization","bearer ".concat(this.appKey)),e.send(),new Promise((function(t,n){e.onload=function(){if(200!=e.status)return n({status:e.status,success:!1});var r=j({},e.response.message||{});delete r.ip;var o=[];for(var i in r){var a=r[i];o.push(a)}z.terminals=o,t(o)},e.onerror=function(){n()}}))}},{key:"validateTerminal",value:function(){var e=this;return!this.laneId||!(z.terminals&&!z.terminals.length)&&!!z.terminals.find((function(t){return t.laneId===e.laneId}))}},{key:"clear",value:function(){this.iframe&&this.messenger.send({action:"clear"}),this.paymentType=null,this.paymentOptions=[],this.iframe=null,this.amount=null,this.transactionId=null,this.ticket=null,this.meta=null,this.onError=null,this.onSuccess=null,this.start=null,this.trial=null,this.cycles=null,this.interval=null,this.frequency=null,this.email=null,this.tokenMode=!1,this.allowTip=!1,this.tipValue=null,this.zipMode=null,this.newWindow=null,this.element=null,this.containerSelector=null,this.styles=null,z.terminals=[],this.laneId=null,this.address=null,this.resize=null,this.payBtnText=null,this.savePaymentToken=null,this.fee=null,this.meta=null,this.meta_id=null,this.secure_form=null,this.autocomplete=!0,this.fullName=!1,this.billingAddress=!1,this.optIn=!1,this.emailOption=!1,this.phoneOption=!1,this.terms=null,this.labels=null,this.url=null,this.description=null}},{key:"init",value:function(){this.newWindow||this.useIframe()}},{key:"getData",value:function(){var e={paymentOptions:this.paymentOptions,paymentType:this.paymentType,amount:this.amount,allowTip:this.allowTip,tipValue:this.tipValue,address:this.address,resize:this.resize,payBtnText:this.payBtnText,savePaymentToken:this.savePaymentToken,start:this.start,cycles:this.cycles,interval:this.interval,frequency:this.frequency,email:this.email,apikey:this.appKey,tokenMode:this.tokenMode,zipMode:this.zipMode,fee:this.fee,meta:this.meta,meta_id:this.secure_form||this.meta_id,source:"iframe",styles:this.styles,autocomplete:this.autocomplete,fullName:this.fullName,billingAddress:this.billingAddress,optIn:this.optIn,emailOption:this.emailOption,phoneOption:this.phoneOption,terms:this.terms,labels:this.labels,description:this.description};return+this.trial&&(e.trial=+this.trial),this.paymentOptions.includes("terminal")&&(e.terminal=this.laneId),e}},{key:"process",value:function(){var e=this;if(this.newWindow){var t=j(j({},this.getData()),{},{location:window.location.href,newWindow:!0}),r=v(t),o=g("payment",r,this.url),i=window.open(o,"_blank","left=100,top=100,height=600,width=520,fullscreen=no,location=no,status=no,menubar=no,toolbar=no");window.onmessage=function(t){if(n.includes(t.origin)){var r=JSON.parse(t.data||"{}");r.status?(e.onSuccess(r),i.close()):e.onError(r)}}}}},{key:"processPayment",value:function(){this.process()}},{key:"getDomElement",value:function(){var e=document.querySelector(this.containerSelector);if(!e)throw new Error("Such container doesn't exist");return e}},{key:"getIframeElement",value:function(){var e=document.querySelector("#".concat(a));if(!e)throw new Error("Such iframe doesn't exist");return e}},{key:"useIframe",value:function(){var e=this.getDomElement();this.element=e;var t=this.getData();this.iframe=function(e,t,n,r){e.innerHTML="";var o=function(e,t,n){var r=document.createElement("iframe");return r.setAttribute("allow","payment"),r.style=C,r.src=g(e,t,n),r.id=a,r}(t,v(n),r);return e.appendChild(o),o}(e,this.appKey,t,this.url),this.createMessenger()}},{key:"changeIframeSize",value:function(e){var t=e.payload,n=this.getIframeElement();if("number"==typeof t&&t)return n.style.height="".concat(t,"px"),void(n.style.minHeight="".concat(t,"px"));n.style.height="".concat(t?520:390,"px")}},{key:"createMessenger",value:function(){this.messenger=new T({iframe:this.iframe,messageHandler:this.handleIncomingMessage.bind(this)}),this.messenger.subscribe()}},{key:"handleIncomingMessage",value:function(e){var t=JSON.parse(e.data||"{}");"change-iframe-size"!==t.action?"error"!==t.action?"success"!==t.action||this.onSuccess(t):this.onError(t):this.changeIframeSize(t)}},{key:"changeStyleProperties",value:function(e,t){var n=this;return this.styles=this.styles||{},e.split(",").forEach((function(e){b(e.split("."),n.styles,t)})),this}},{key:"primaryColor",value:function(e){return this.changeStyleProperties("button.background,radio.checked.color,radio.checked.borderColor,input.focus.borderColor",e)}},{key:"small",value:function(){return this}},{key:"inputBgColor",value:function(e){return this.changeStyleProperties("input.background",e)}},{key:"inputTextColor",value:function(e){return this.changeStyleProperties("input.color",e)}},{key:"inputBorderColor",value:function(e){return this.changeStyleProperties("input.borderColor",e)}},{key:"inputBorderWidth",value:function(e){return this.changeStyleProperties("input.borderWidth",e)}},{key:"inputHeight",value:function(e){return this.changeStyleProperties("input.height",e)}},{key:"inputFontSize",value:function(e){return this.changeStyleProperties("input.fontSize",e)}},{key:"inputFontWeight",value:function(e){return this.changeStyleProperties("input.fontWeight",e)}},{key:"inputPlaceholderColor",value:function(e){return this.changeStyleProperties("input.placeholder.color",e)}},{key:"inputPlaceholderFontSize",value:function(e){return this.changeStyleProperties("input.placeholder.fontSize",e)}},{key:"inputPlaceholderFontWeight",value:function(e){return this.changeStyleProperties("input.placeholder.fontWeight",e)}},{key:"inputErrorBackground",value:function(e){return this.changeStyleProperties("input.error.background",e)}},{key:"buttonHeight",value:function(e){return this.changeStyleProperties("button.height",e)}},{key:"buttonBackground",value:function(e){return this.changeStyleProperties("button.background",e)}},{key:"buttonBorderRadius",value:function(e){return this.changeStyleProperties("button.borderRadius",e)}},{key:"buttonFontSize",value:function(e){return this.changeStyleProperties("button.fontSize",e)}},{key:"buttonColor",value:function(e){return this.changeStyleProperties("button.color",e)}},{key:"buttonHoverBackground",value:function(e){return this.changeStyleProperties("button.hover.background",e)}},{key:"buttonHoverColor",value:function(e){return this.changeStyleProperties("button.hover.color",e)}},{key:"buttonActiveBackground",value:function(e){return this.changeStyleProperties("button.active.background",e)}},{key:"buttonActiveColor",value:function(e){return this.changeStyleProperties("button.active.color",e)}},{key:"radioFontSize",value:function(e){return this.changeStyleProperties("radio.fontSize",e)}},{key:"radioColor",value:function(e){return this.changeStyleProperties("radio.color",e)}},{key:"radioBorderRadius",value:function(e){return this.changeStyleProperties("radio.borderRadius",e)}},{key:"radioBorderColor",value:function(e){return this.changeStyleProperties("radio.borderColor",e)}},{key:"radioFontWeight",value:function(e){return this.changeStyleProperties("radio.fontWeight",e)}},{key:"radioBackground",value:function(e){return this.changeStyleProperties("radio.background",e)}},{key:"radioCheckedColor",value:function(e){return this.changeStyleProperties("radio.checked.color",e)}},{key:"radioCheckedBackground",value:function(e){return this.changeStyleProperties("radio.checked.background",e)}},{key:"radioCheckedBorderColor",value:function(e){return this.changeStyleProperties("radio.checked.borderColor",e)}},{key:"radioCheckedFontSize",value:function(e){return this.changeStyleProperties("radio.checked.fontSize",e)}},{key:"radioCheckedFontWeight",value:function(e){return this.changeStyleProperties("radio.checked.fontWeight",e)}},{key:"cryptoBackground",value:function(e){return this.changeStyleProperties("cryptoCheck.background",e)}},{key:"cryptoColor",value:function(e){return this.changeStyleProperties("cryptoCheck.color",e)}},{key:"cryptoBorderRadius",value:function(e){return this.changeStyleProperties("cryptoCheck.borderRadius",e)}},{key:"cryptoBorderColor",value:function(e){return this.changeStyleProperties("cryptoCheck.borderColor",e)}},{key:"cryptoFontSize",value:function(e){return this.changeStyleProperties("cryptoCheck.fontSize",e)}},{key:"cryptoFontWeight",value:function(e){return this.changeStyleProperties("cryptoCheck.fontWeight",e)}},{key:"cryptoActiveBackground",value:function(e){return this.changeStyleProperties("cryptoCheck.active.background",e)}},{key:"cryptoHoverColor",value:function(e){return this.changeStyleProperties("cryptoCheck.hover.color",e)}},{key:"cryptoHoverBackground",value:function(e){return this.changeStyleProperties("cryptoCheck.hover.background",e)}},{key:"cryptoHoverBorderColor",value:function(e){return this.changeStyleProperties("cryptoCheck.hover.borderColor",e)}},{key:"cryptoCheckedColor",value:function(e){return this.changeStyleProperties("cryptoCheck.checked.color",e)}},{key:"cryptoCheckedBackground",value:function(e){return this.changeStyleProperties("cryptoCheck.checked.background",e)}},{key:"cryptoCheckedBorderColor",value:function(e){return this.changeStyleProperties("cryptoCheck.checked.borderColor",e)}},{key:"errorColor",value:function(e){return this.changeStyleProperties("input.error.borderColor,input.errorText.color,error.bodyError.color",e)}}])&&A(t.prototype,p),Object.defineProperty(t,"prototype",{writable:!1}),e}();return _(R,"INTERVAL_ENUM",{DAILY:"daily",WEEKLY:"weekly",MONTHLY:"monthly",YEARLY:"yearly"}),_(R,"PAYMENT_TYPES_ENUM",c),_(R,"ZIP_MODES_ENUM",l),_(R,"TOKEN_MODES_ENUM",s),_(R,"PAYMENT_ENUM",{CARD:"credit_card",BANK:"bank",CRYPTO:"crypto",TERMINAL:"terminal",DIGITAL:"digital"}),window&&!window.Triple&&(window.Triple=R),t})()}));